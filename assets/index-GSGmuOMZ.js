import{d as Oe,r as i,a as X,v as je,k as Ke,D as He,a6 as we,c as Xe,e as t,w as l,f as d,H as Ye,E as S,x as ie,M as Ze,m as k,b as s,N as Y,t as _,j as u,g as F,S as Ge,X as q,i as Je,a1 as Qe,a7 as We,Y as et,a2 as tt,Z as lt,o as y}from"./index-BAfmE6z6.js";import{g as Z,i as G}from"./index-BjzP5g9D.js";import{_ as at}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ot={class:"monitor-container"},st={class:"card-header"},nt={class:"header-right"},rt={class:"monitor-item"},it={class:"item-progress"},ut={class:"monitor-item"},dt={class:"item-progress"},pt={class:"monitor-item"},mt={class:"item-progress"},ct={class:"monitor-item"},vt={class:"item-progress"},ft={class:"monitor-charts"},gt={class:"card-header"},_t={class:"header-right"},yt={class:"operation-bar"},ht={class:"table-actions"},bt={class:"pagination"},wt={class:"card-header"},kt={class:"header-right"},xt={class:"pagination"},Ct={class:"dialog-footer"},Vt={class:"dialog-footer"},zt=Oe({__name:"index",setup(Ut){const J=i(!1);let x=null;const c=X({cpu:45,memory:60,storage:35,network:50}),N=i(!1),I=i([]),ue=i([{id:1,time:"2025-05-20 10:30:00",level:"critical",content:"服务器A CPU使用率超过90%",source:"服务器A",status:"pending",processMethod:"",processComment:"",processTime:""},{id:2,time:"2025-05-20 09:15:00",level:"warning",content:"存储阵列B空间使用率超过80%",source:"存储阵列B",status:"processing",processMethod:"",processComment:"",processTime:""},{id:3,time:"2025-05-19 16:45:00",level:"info",content:"系统有新补丁可用",source:"系统",status:"resolved",processMethod:"",processComment:"",processTime:""}]),C=i([...ue.value]),ke=i([{id:1,time:"2025-05-20 10:00:00",level:"info",module:"系统",content:"系统启动成功",operator:"系统管理员"},{id:2,time:"2025-05-20 09:55:00",level:"warning",module:"CPU",content:"CPU使用率超过80%",operator:"监控系统"}]),M=i(!1),$=i(!1),Q=i(),n=X({name:"",type:"",level:"",threshold:80,duration:5,notifyMethods:["email"],description:""}),R=i(!1),W=i(),g=X({method:"",comment:""}),xe={name:[{required:!0,message:"请输入告警名称",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],type:[{required:!0,message:"请选择告警类型",trigger:"change"}],level:[{required:!0,message:"请选择告警级别",trigger:"change"}],threshold:[{required:!0,message:"请输入阈值",trigger:"blur"}],duration:[{required:!0,message:"请输入持续时间",trigger:"blur"}],notifyMethods:[{required:!0,message:"请选择通知方式",trigger:"change"}]},Ce={method:[{required:!0,message:"请选择处理方式",trigger:"change"}],comment:[{required:!0,message:"请输入处理说明",trigger:"blur"}]},P=i(),T=i(),E=i(),L=i(),r=X({keyword:"",level:"",status:""}),V=i(1),B=i(10),de=i(0),ee=i(1),te=i(10),Ve=i(0),pe=je(()=>!!r.level||!!r.status||!!r.keyword),ze=a=>({info:"info",warning:"warning",error:"danger"})[a]||"info",me=a=>a==="critical"?"严重":a==="warning"?"警告":a==="info"?"提示":a,ce=a=>a==="pending"?"未处理":a==="processing"?"处理中":a==="resolved"?"已处理":a,Ue=a=>a==="pending"?"danger":a==="processing"?"warning":a==="resolved"?"success":"info",O=i(!0),j=i(null),Se=()=>{O.value=!0,Ye(()=>{try{if(!P.value||!T.value||!E.value||!L.value){console.warn("Chart DOM elements not ready");return}const a=G(P.value);a.setOption({title:{text:"CPU使用率趋势"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"]},yAxis:{type:"value",max:100},series:[{data:[30,40,35,50,45,60,55,45],type:"line",smooth:!0,areaStyle:{opacity:.3}}]});const e=G(T.value);e.setOption({title:{text:"内存使用率趋势"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"]},yAxis:{type:"value",max:100},series:[{data:[50,55,60,65,70,65,60,55],type:"line",smooth:!0,areaStyle:{opacity:.3}}]});const z=G(E.value);z.setOption({title:{text:"存储使用率趋势"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"]},yAxis:{type:"value",max:100},series:[{data:[35,38,40,42,45,43,40,38],type:"line",smooth:!0,areaStyle:{opacity:.3}}]});const b=G(L.value);b.setOption({title:{text:"网络带宽趋势"},tooltip:{trigger:"axis"},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"]},yAxis:{type:"value",max:100},series:[{data:[45,50,48,55,60,58,52,48],type:"line",smooth:!0,areaStyle:{opacity:.3}}]});const w=()=>{try{a.resize(),e.resize(),z.resize(),b.resize()}catch(m){console.error("Error resizing charts:",m)}};window.addEventListener("resize",w),we(()=>{window.removeEventListener("resize",w);try{a.dispose(),e.dispose(),z.dispose(),b.dispose()}catch(m){console.error("Error disposing charts:",m)}}),O.value=!1}catch(a){console.error("Error initializing charts:",a),O.value=!1,S.error("图表初始化失败")}})},h=()=>{let a=[...ue.value];r.keyword&&(a=a.filter(e=>e.content.includes(r.keyword)||e.source.includes(r.keyword))),r.level&&(a=a.filter(e=>e.level===r.level)),r.status&&(a=a.filter(e=>e.status===r.status)),de.value=a.length,C.value=a.slice((V.value-1)*B.value,V.value*B.value)},ve=()=>{r.keyword="",r.level="",r.status="",V.value=1,h()},le=a=>{r[a]="",V.value=1,h()},Me=a=>{B.value=a,h()},Re=a=>{V.value=a,h()},Ae=a=>{te.value=a},Pe=a=>{ee.value=a};Ke(J,a=>{a?x=window.setInterval(()=>{fe()},3e4):x&&(clearInterval(x),x=null)});const fe=()=>{N.value=!0,setTimeout(()=>{N.value=!1,S.success("数据已刷新")},1e3)},Te=()=>{$.value=!1,M.value=!0,n.name="",n.type="",n.level="",n.threshold=80,n.duration=5,n.notifyMethods=["email"],n.description=""},Ee=a=>{$.value=!0,M.value=!0,n.name=a.name,n.type=a.type,n.level=a.level,n.threshold=a.threshold,n.duration=a.duration,n.notifyMethods=a.notifyMethods,n.description=a.description},Le=a=>{j.value=a,R.value=!0,g.method="",g.comment=""},Be=()=>{if(I.value.length===0){S.warning("请选择要处理的告警");return}j.value=I.value[0],R.value=!0,g.method="",g.comment=""},De=a=>{lt.confirm(`确认删除告警"${a.content}"吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{S.success("删除成功")})},Fe=()=>{S.success("日志导出中")},qe=async()=>{Q.value&&await Q.value.validate(a=>{a&&(M.value=!1,S.success($.value?"编辑成功":"添加成功"))})},Ne=async()=>{W.value&&W.value.validate(a=>{if(a){const e=C.value.findIndex(z=>{var b;return z.id===((b=j.value)==null?void 0:b.id)});e!==-1&&(C.value[e].status="resolved",C.value[e].processMethod=g.method,C.value[e].processComment=g.comment,C.value[e].processTime=new Date().toLocaleString(),h(),S.success("处理成功")),R.value=!1,j.value=null}})},Ie=a=>{I.value=a};return He(()=>{setTimeout(()=>{Se()},100),h()}),we(()=>{x&&(clearInterval(x),x=null),[P.value&&Z(P.value),T.value&&Z(T.value),E.value&&Z(E.value),L.value&&Z(L.value)].forEach(e=>{e&&e.dispose()})}),(a,e)=>{const z=d("el-switch"),b=d("el-tooltip"),w=d("el-icon"),m=d("el-button"),K=d("el-progress"),U=d("el-col"),ae=d("el-row"),oe=d("el-card"),H=d("el-input"),v=d("el-form-item"),p=d("el-option"),D=d("el-select"),se=d("el-form"),A=d("el-tag"),f=d("el-table-column"),ge=d("el-table"),_e=d("el-pagination"),ye=d("el-input-number"),ne=d("el-checkbox"),$e=d("el-checkbox-group"),he=d("el-dialog"),re=Ze("loading");return y(),Xe("div",ot,[t(ae,{gutter:20},{default:l(()=>[t(U,{span:24},{default:l(()=>[ie((y(),k(oe,{class:"monitor-card"},{header:l(()=>[s("div",st,[e[25]||(e[25]=s("span",null,"系统监控",-1)),s("div",nt,[t(b,{content:"自动刷新",placement:"top"},{default:l(()=>[t(z,{modelValue:J.value,"onUpdate:modelValue":e[0]||(e[0]=o=>J.value=o),"active-text":"自动"},null,8,["modelValue"])]),_:1}),t(m,{type:"primary",onClick:fe},{default:l(()=>[t(w,null,{default:l(()=>[t(F(Ge))]),_:1}),e[24]||(e[24]=u("刷新 "))]),_:1,__:[24]})])])]),default:l(()=>[t(ae,{gutter:20},{default:l(()=>[t(U,{span:6},{default:l(()=>[s("div",rt,[e[26]||(e[26]=s("div",{class:"item-title"},"CPU使用率",-1)),s("div",{class:Y(["item-value",{warning:c.cpu>80}])},_(c.cpu)+"%",3),s("div",it,[t(K,{percentage:c.cpu,status:c.cpu>80?"exception":"","stroke-width":8},null,8,["percentage","status"])])])]),_:1}),t(U,{span:6},{default:l(()=>[s("div",ut,[e[27]||(e[27]=s("div",{class:"item-title"},"内存使用率",-1)),s("div",{class:Y(["item-value",{warning:c.memory>80}])},_(c.memory)+"%",3),s("div",dt,[t(K,{percentage:c.memory,status:c.memory>80?"exception":"","stroke-width":8},null,8,["percentage","status"])])])]),_:1}),t(U,{span:6},{default:l(()=>[s("div",pt,[e[28]||(e[28]=s("div",{class:"item-title"},"存储使用率",-1)),s("div",{class:Y(["item-value",{warning:c.storage>80}])},_(c.storage)+"%",3),s("div",mt,[t(K,{percentage:c.storage,status:c.storage>80?"exception":"","stroke-width":8},null,8,["percentage","status"])])])]),_:1}),t(U,{span:6},{default:l(()=>[s("div",ct,[e[29]||(e[29]=s("div",{class:"item-title"},"网络带宽",-1)),s("div",{class:Y(["item-value",{warning:c.network>80}])},_(c.network)+"Mbps",3),s("div",vt,[t(K,{percentage:c.network,status:c.network>80?"exception":"","stroke-width":8},null,8,["percentage","status"])])])]),_:1})]),_:1}),s("div",ft,[s("div",{ref_key:"cpuChartRef",ref:P,class:"chart"},null,512),s("div",{ref_key:"memoryChartRef",ref:T,class:"chart"},null,512),s("div",{ref_key:"storageChartRef",ref:E,class:"chart"},null,512),s("div",{ref_key:"networkChartRef",ref:L,class:"chart"},null,512)])]),_:1})),[[re,O.value]])]),_:1}),t(U,{span:24,class:"mt-20"},{default:l(()=>[t(oe,null,{header:l(()=>[s("div",gt,[e[32]||(e[32]=s("span",null,"告警管理",-1)),s("div",_t,[t(m,{type:"success",onClick:Be,disabled:!I.value.length},{default:l(()=>[t(w,null,{default:l(()=>[t(F(We))]),_:1}),e[30]||(e[30]=u("批量处理 "))]),_:1,__:[30]},8,["disabled"]),t(m,{type:"primary",onClick:Te},{default:l(()=>[t(w,null,{default:l(()=>[t(F(et))]),_:1}),e[31]||(e[31]=u("添加告警规则 "))]),_:1,__:[31]})])])]),default:l(()=>[s("div",yt,[t(se,{inline:!0,model:r,class:"search-form"},{default:l(()=>[t(v,null,{default:l(()=>[t(H,{modelValue:r.keyword,"onUpdate:modelValue":e[1]||(e[1]=o=>r.keyword=o),placeholder:"告警内容/来源",clearable:"",onKeyup:Je(h,["enter"])},{prefix:l(()=>[t(w,null,{default:l(()=>[t(F(Qe))]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:l(()=>[t(D,{modelValue:r.level,"onUpdate:modelValue":e[2]||(e[2]=o=>r.level=o),placeholder:"级别",clearable:"",style:{width:"120px"}},{default:l(()=>[t(p,{label:"严重",value:"critical"}),t(p,{label:"警告",value:"warning"}),t(p,{label:"提示",value:"info"})]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:l(()=>[t(D,{modelValue:r.status,"onUpdate:modelValue":e[3]||(e[3]=o=>r.status=o),placeholder:"状态",clearable:"",style:{width:"120px"}},{default:l(()=>[t(p,{label:"未处理",value:"pending"}),t(p,{label:"处理中",value:"processing"}),t(p,{label:"已处理",value:"resolved"})]),_:1},8,["modelValue"])]),_:1}),t(v,null,{default:l(()=>[t(m,{type:"primary",onClick:h},{default:l(()=>e[33]||(e[33]=[u("搜索")])),_:1,__:[33]}),t(m,{onClick:ve},{default:l(()=>e[34]||(e[34]=[u("重置")])),_:1,__:[34]})]),_:1})]),_:1},8,["model"])]),pe.value?(y(),k(ae,{key:0,class:"filter-tags",style:{"margin-bottom":"10px"}},{default:l(()=>[r.level?(y(),k(A,{key:0,type:"info",closable:"",onClose:e[4]||(e[4]=()=>le("level"))},{default:l(()=>[u(" 级别："+_(me(r.level)),1)]),_:1})):q("",!0),r.status?(y(),k(A,{key:1,type:"info",closable:"",onClose:e[5]||(e[5]=()=>le("status"))},{default:l(()=>[u(" 状态："+_(ce(r.status)),1)]),_:1})):q("",!0),r.keyword?(y(),k(A,{key:2,type:"info",closable:"",onClose:e[6]||(e[6]=()=>le("keyword"))},{default:l(()=>[u(" 关键词："+_(r.keyword),1)]),_:1})):q("",!0),pe.value?(y(),k(m,{key:3,size:"small",type:"text",onClick:ve},{default:l(()=>e[35]||(e[35]=[u("清除全部")])),_:1,__:[35]})):q("",!0)]),_:1})):q("",!0),ie((y(),k(ge,{data:C.value,border:"",style:{width:"100%"},onSelectionChange:Ie},{default:l(()=>[t(f,{type:"selection",width:"55"}),t(f,{prop:"time",label:"时间","min-width":"160",sortable:""}),t(f,{prop:"level",label:"级别","min-width":"80"},{default:l(({row:o})=>[t(A,{type:o.level==="critical"?"danger":o.level==="warning"?"warning":"info"},{default:l(()=>[u(_(me(o.level)),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"content",label:"内容","min-width":"200","show-overflow-tooltip":""}),t(f,{prop:"source",label:"来源","min-width":"120"}),t(f,{prop:"status",label:"状态","min-width":"100"},{default:l(({row:o})=>[t(A,{type:Ue(o.status)},{default:l(()=>[u(_(ce(o.status)),1)]),_:2},1032,["type"])]),_:1}),t(f,{label:"操作",width:"280",fixed:"right"},{default:l(({row:o})=>[s("div",ht,[t(m,{type:"primary",link:"",onClick:be=>Le(o)},{default:l(()=>e[36]||(e[36]=[u("处理")])),_:2,__:[36]},1032,["onClick"]),t(m,{type:"success",link:"",onClick:be=>Ee(o)},{default:l(()=>e[37]||(e[37]=[u("编辑")])),_:2,__:[37]},1032,["onClick"]),t(m,{type:"danger",link:"",onClick:be=>De(o)},{default:l(()=>e[38]||(e[38]=[u("删除")])),_:2,__:[38]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[re,N.value]]),s("div",bt,[t(_e,{"current-page":V.value,"onUpdate:currentPage":e[7]||(e[7]=o=>V.value=o),"page-size":B.value,"onUpdate:pageSize":e[8]||(e[8]=o=>B.value=o),"page-sizes":[10,20,50,100],total:de.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Me,onCurrentChange:Re},null,8,["current-page","page-size","total"])])]),_:1})]),_:1}),t(U,{span:24,class:"mt-20"},{default:l(()=>[t(oe,null,{header:l(()=>[s("div",wt,[e[40]||(e[40]=s("span",null,"系统日志",-1)),s("div",kt,[t(m,{type:"primary",onClick:Fe},{default:l(()=>[t(w,null,{default:l(()=>[t(F(tt))]),_:1}),e[39]||(e[39]=u("导出日志 "))]),_:1,__:[39]})])])]),default:l(()=>[ie((y(),k(ge,{data:ke.value,style:{width:"100%"},border:""},{default:l(()=>[t(f,{prop:"time",label:"时间",width:"180",sortable:""}),t(f,{prop:"level",label:"级别",width:"100"},{default:l(({row:o})=>[t(A,{type:ze(o.level)},{default:l(()=>[u(_(o.level),1)]),_:2},1032,["type"])]),_:1}),t(f,{prop:"module",label:"模块",width:"120"}),t(f,{prop:"content",label:"内容","show-overflow-tooltip":""}),t(f,{prop:"operator",label:"操作人",width:"120"})]),_:1},8,["data"])),[[re,N.value]]),s("div",xt,[t(_e,{"current-page":ee.value,"onUpdate:currentPage":e[9]||(e[9]=o=>ee.value=o),"page-size":te.value,"onUpdate:pageSize":e[10]||(e[10]=o=>te.value=o),"page-sizes":[10,20,50,100],total:Ve.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Ae,onCurrentChange:Pe},null,8,["current-page","page-size","total"])])]),_:1})]),_:1})]),_:1}),t(he,{modelValue:M.value,"onUpdate:modelValue":e[19]||(e[19]=o=>M.value=o),title:$.value?"编辑告警规则":"添加告警规则",width:"600px"},{footer:l(()=>[s("span",Ct,[t(m,{onClick:e[18]||(e[18]=o=>M.value=!1)},{default:l(()=>e[45]||(e[45]=[u("取消")])),_:1,__:[45]}),t(m,{type:"primary",onClick:qe},{default:l(()=>e[46]||(e[46]=[u("确定")])),_:1,__:[46]})])]),default:l(()=>[t(se,{ref_key:"alertFormRef",ref:Q,model:n,rules:xe,"label-width":"100px"},{default:l(()=>[t(v,{label:"告警名称",prop:"name"},{default:l(()=>[t(H,{modelValue:n.name,"onUpdate:modelValue":e[11]||(e[11]=o=>n.name=o),placeholder:"请输入告警名称"},null,8,["modelValue"])]),_:1}),t(v,{label:"告警类型",prop:"type"},{default:l(()=>[t(D,{modelValue:n.type,"onUpdate:modelValue":e[12]||(e[12]=o=>n.type=o),placeholder:"请选择告警类型"},{default:l(()=>[t(p,{label:"CPU告警",value:"cpu"}),t(p,{label:"内存告警",value:"memory"}),t(p,{label:"存储告警",value:"storage"}),t(p,{label:"网络告警",value:"network"}),t(p,{label:"应用告警",value:"application"}),t(p,{label:"安全告警",value:"security"})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"告警级别",prop:"level"},{default:l(()=>[t(D,{modelValue:n.level,"onUpdate:modelValue":e[13]||(e[13]=o=>n.level=o),placeholder:"请选择告警级别"},{default:l(()=>[t(p,{label:"一般",value:"normal"}),t(p,{label:"警告",value:"warning"}),t(p,{label:"严重",value:"critical"})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"阈值",prop:"threshold"},{default:l(()=>[t(ye,{modelValue:n.threshold,"onUpdate:modelValue":e[14]||(e[14]=o=>n.threshold=o),min:0,max:100},null,8,["modelValue"])]),_:1}),t(v,{label:"持续时间",prop:"duration"},{default:l(()=>[t(ye,{modelValue:n.duration,"onUpdate:modelValue":e[15]||(e[15]=o=>n.duration=o),min:1,max:60},null,8,["modelValue"]),e[41]||(e[41]=s("span",{class:"unit"},"分钟",-1))]),_:1,__:[41]}),t(v,{label:"通知方式",prop:"notifyMethods"},{default:l(()=>[t($e,{modelValue:n.notifyMethods,"onUpdate:modelValue":e[16]||(e[16]=o=>n.notifyMethods=o)},{default:l(()=>[t(ne,{label:"email"},{default:l(()=>e[42]||(e[42]=[u("邮件")])),_:1,__:[42]}),t(ne,{label:"sms"},{default:l(()=>e[43]||(e[43]=[u("短信")])),_:1,__:[43]}),t(ne,{label:"wechat"},{default:l(()=>e[44]||(e[44]=[u("微信")])),_:1,__:[44]})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"描述"},{default:l(()=>[t(H,{modelValue:n.description,"onUpdate:modelValue":e[17]||(e[17]=o=>n.description=o),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(he,{modelValue:R.value,"onUpdate:modelValue":e[23]||(e[23]=o=>R.value=o),title:"处理告警",width:"500px"},{footer:l(()=>[s("span",Vt,[t(m,{onClick:e[22]||(e[22]=o=>R.value=!1)},{default:l(()=>e[47]||(e[47]=[u("取消")])),_:1,__:[47]}),t(m,{type:"primary",onClick:Ne},{default:l(()=>e[48]||(e[48]=[u("确定")])),_:1,__:[48]})])]),default:l(()=>[t(se,{ref_key:"processFormRef",ref:W,model:g,rules:Ce,"label-width":"100px"},{default:l(()=>[t(v,{label:"处理方式",prop:"method"},{default:l(()=>[t(D,{modelValue:g.method,"onUpdate:modelValue":e[20]||(e[20]=o=>g.method=o),placeholder:"请选择处理方式"},{default:l(()=>[t(p,{label:"重启服务",value:"restart"}),t(p,{label:"清理缓存",value:"clear"}),t(p,{label:"扩容资源",value:"scale"}),t(p,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),t(v,{label:"处理说明",prop:"comment"},{default:l(()=>[t(H,{modelValue:g.comment,"onUpdate:modelValue":e[21]||(e[21]=o=>g.comment=o),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),At=at(zt,[["__scopeId","data-v-f5052eee"]]);export{At as default};
